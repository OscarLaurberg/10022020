<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>Fetch from movieAPI</title>
        <style>
            table, th, td {
                border: 1px solid black;
            }
            td{
                padding: 3px;
            }
        </style>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>
    <body>

        <h2>Her arbejder vi med mit eget api</h2>


        <input type ='number' id='movieId' value=''/><button id='getUser'>Get movie from id</button><button id='getAllMovies'>Get all movies</button>
        <div id='movieResult'> </div>
        <br>
        <button onclick="goBack()">Go back</button>
    </body>
    <script>
        function getAllMovies(evt) {
            fetch("http://localhost:8080/rest-jpa-devops-starter/api/movie/all")
                    .then(res => res.json()) //in flow1, just do it
                    .then(data => {
                        // Inside this callback, and only here, the response data is available
                        console.log("data", data);
                        let tableString = "<table> <tr> <th>Title</th><th>Year</th></tr>";
                        let movieTableArray = data.map(data => data = `<tr><td>${data.name} </td><td>${data.year} </td></tr>`);
                        movieTableArray.forEach(data => {
                            tableString += data;
                        });
                        tableString += "</table> </tr>";
                        document.getElementById("movieResult").innerHTML = tableString;
                        /* data now contains the response, converted to JavaScript
                         Observe the output from the log-output above
                         Now, just build your DOM changes using the data*/
                    });



        }
        document.getElementById('getAllMovies').addEventListener('click', getAllMovies);
    </script>
</html>
